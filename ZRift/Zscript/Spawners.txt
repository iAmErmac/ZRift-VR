
Class ZRiftItemSpawnHandler: EventHandler
{
	override void OnRegister()
	{
		_isInitialized = false;
	}
	
	private void UpdateSettings()
	{
		_isTitlemap = CheckTitlemap();
		if (_isTitlemap) return;
		
		PlayerInfo player = players[consolePlayer];
		if (player == null) return;
		
		replace_items = CVar.GetCVar("zrift_items", player).GetBool();
		_isInitialized = true;
	}
	
	override void CheckReplacement(ReplaceEvent e)
	{
		if (!_isInitialized) { UpdateSettings(); }
		
		if(GameInfo.GameType & GAME_Doom)
		{
			if(replace_items)
			{
				//items
				if(e.Replacee is "ArmorBonus") 			e.Replacement = 'ArmorBonusSpawner';
				if(e.Replacee is "HealthBonus") 		e.Replacement = 'HealthBonusSpawner';
				if(e.Replacee is "GreenArmor") 			e.Replacement = 'YellowVest';
				if(e.Replacee is "BlueArmor") 			e.Replacement = 'RedVest';
				if(e.Replacee is "StimPack") 			e.Replacement = 'SmallHealth';
				if(e.Replacee is "Medikit") 			e.Replacement = 'BigHealth';
				if(e.Replacee is "BackPack") 			e.Replacement = 'AmmoPack';
				if(e.Replacee is "AllMap") 				e.Replacement = 'GlobusMap';
				if(e.Replacee is "SoulSphere") 			e.Replacement = 'LesserRiftCharge';
				if(e.Replacee is "MegaSphere") 			e.Replacement = 'GreaterRiftCharge';
				if(e.Replacee is "InvulnerabilitySphere") 	e.Replacement = 'ChojinMask';
				if(e.Replacee is "BlurSphere") 			e.Replacement = 'InvisibilityMask';
				if(e.Replacee is "Berserk") 			e.Replacement = 'BerserkPack';
				if(e.Replacee is "InfraRed") 			e.Replacement = 'ChasmInfra';
				if(e.Replacee is "ChasmHazmat") 		e.Replacement = 'Radsuit';
				
				//barrel
				if(e.Replacee is "BurningBarrel") 		e.Replacement = 'ChasmBarrelFire';
			
				//decorations
				if(e.Replacee is "Candelabra") 			e.Replacement = 'ChasmCandelabraSpawner';
				if(e.Replacee is "Candlestick") 		e.Replacement = 'ChasmCandlestickSpawner';
				if(e.Replacee is "Techlamp") 			e.Replacement = 'ChasmTechlampSpawner';
				if(e.Replacee is "Techlamp2") 			e.Replacement = 'ChasmTechlamp2Spawner';
				if(e.Replacee is "Column") 				e.Replacement = 'ChasmColumnSpawner';
				if(e.Replacee is "EvilEye") 			e.Replacement = 'DoomEvilEyeSpawner';
				if(e.Replacee is "HeadCandles") 		e.Replacement = 'DoomHeadCandlesSpawner';
				if(e.Replacee is "FloatingSkull") 		e.Replacement = 'DoomFloatingSkullSpawner';
				if(e.Replacee is "Stalagmite") 			e.Replacement = 'DoomStalagmiteSpawner';
				if(e.Replacee is "Stalagtite") 			e.Replacement = 'DoomStalagtiteSpawner';
				if(e.Replacee is "TallGreenColumn") 	e.Replacement = 'ChasmTallGreenColumnSpawner';
				if(e.Replacee is "TallRedColumn") 		e.Replacement = 'ChasmTallRedColumnSpawner';
				if(e.Replacee is "TechPillar") 			e.Replacement = 'TechPillarChasm';
				if(e.Replacee is "ShortGreenColumn") 	e.Replacement = 'PostSpawner1';
				if(e.Replacee is "HeartColumn") 		e.Replacement = 'PostSpawner2';
				if(e.Replacee is "ShortRedColumn") 		e.Replacement = 'PostSpawner3';
				if(e.Replacee is "SkullColumn") 		e.Replacement = 'PostSpawner4';
				if(e.Replacee is "BigTree") 			e.Replacement = 'TreeSpawner1';
				if(e.Replacee is "TorchTree") 			e.Replacement = 'TreeSpawner2';
				
				//torches
				if(e.Replacee is "BlueTorch") 			e.Replacement = 'ChasmBlueTorchSpawner';
				if(e.Replacee is "GreenTorch") 			e.Replacement = 'ChasmGreenTorchSpawner';
				if(e.Replacee is "RedTorch") 			e.Replacement = 'ChasmRedTorchSpawner';
				if(e.Replacee is "ShortBlueTorch") 		e.Replacement = 'ChasmShortBlueTorchSpawner';
				if(e.Replacee is "ShortGreenTorch") 	e.Replacement = 'ChasmShortGreenTorchSpawner';
				if(e.Replacee is "ShortRedTorch") 		e.Replacement = 'ChasmShortRedTorchSpawner';
				
				//corpses
				if(e.Replacee is "ExplosiveBarrel") 	e.Replacement = 'BarrelSpawner';
				if(e.Replacee is "DeadZombieman") 		e.Replacement = 'ZombieBodySpawner1';
				if(e.Replacee is "DeadShotgunGuy") 		e.Replacement = 'ZombieBodySpawner2';
				if(e.Replacee is "DeadDoomImp") 		e.Replacement = 'ImpBodySpawner1';
				if(e.Replacee is "DeadDemon") 			e.Replacement = 'DemonBodySpawner1';
				if(e.Replacee is "DeadCacodemon") 		e.Replacement = 'CacoBodySpawner1';
				if(e.Replacee is "DeadStick") 			e.Replacement = 'MarineStickSpawner1';
				if(e.Replacee is "LiveStick") 			e.Replacement = 'MarineStickSpawner2';
				if(e.Replacee is "Meat2") 				e.Replacement = 'MeatSpawner1';
				if(e.Replacee is "NonSolidMeat2") 		e.Replacement = 'NonMeatSpawner1';
				if(e.Replacee is "Meat3") 				e.Replacement = 'MeatSpawner2';
				if(e.Replacee is "NonSolidMeat3") 		e.Replacement = 'NonMeatSpawner2';
				if(e.Replacee is "Meat4") 				e.Replacement = 'MeatSpawner3';
				if(e.Replacee is "NonSolidMeat4") 		e.Replacement = 'NonMeatSpawner3';
				if(e.Replacee is "Meat5") 				e.Replacement = 'MeatSpawner4';
				if(e.Replacee is "NonSolidMeat5") 		e.Replacement = 'NonMeatSpawner4';
				if(e.Replacee is "BloodyTwitch") 		e.Replacement = 'MeatSpawner5';
				if(e.Replacee is "NonSolidTwitch") 		e.Replacement = 'NonMeatSpawner5';
				if(e.Replacee is "HangBNoBrain") 		e.Replacement = 'HangSpawner1';
				if(e.Replacee is "HangNoGuts") 			e.Replacement = 'HangSpawner2';
				if(e.Replacee is "HangTLookingDown") 	e.Replacement = 'HangSpawner3';
				if(e.Replacee is "HangTLookingUp") 		e.Replacement = 'HangSpawner4';
				if(e.Replacee is "HangTNoBrain") 		e.Replacement = 'HangSpawner5';
				if(e.Replacee is "HangTSkull") 			e.Replacement = 'HangSpawner6';
				if(e.Replacee is "HeadOnAStick") 		e.Replacement = 'HeadStickSpawner1';
				if(e.Replacee is "HeadsOnAStick") 		e.Replacement = 'HeadStickSpawner2';
				if(e.Replacee is "Gibbedmarine") 		e.Replacement = 'ChasmGibbedmarineSpawner';
				if(e.Replacee is "GibbedmarineExtra") 	e.Replacement = 'ChasmGibbedmarineExtraSpawner';
				
				//gibs
				if(e.Replacee is "BrainStem") 			e.Replacement = 'ChasmBrainStemSpawner';
				if(e.Replacee is "ColonGibs") 			e.Replacement = 'ChasmColonGibsSpawner';
				if(e.Replacee is "SmallBloodPool") 		e.Replacement = 'ChasmSmallBloodPoolSpawner';
				if(e.Replacee is "Gibs") 				e.Replacement = 'ChasmRealGibsSpawner';
			}
		}
		
		if(GameInfo.GameType & GAME_Heretic)
		{
			/*
			//ammo
			if(e.Replacee is "GoldWandAmmo") 		e.Replacement = 'GoldAmmoSpawner';
			if(e.Replacee is "GoldWandHefty") 		e.Replacement = 'GoldAmmoBoxSpawner';
			if(e.Replacee is "CrossbowAmmo") 		e.Replacement = 'CrossAmmoSpawner';
			if(e.Replacee is "CrossbowHefty") 		e.Replacement = 'CrossBoxSpawner';
			if(e.Replacee is "BlasterAmmo") 		e.Replacement = 'BlasterAmmoSpawner';
			if(e.Replacee is "BlasterHefty") 		e.Replacement = 'BlasterBoxSpawner';
			if(e.Replacee is "PhoenixRodAmmo") 		e.Replacement = 'PhoenixAmmoSpawner';
			if(e.Replacee is "PhoenixRodHefty") 	e.Replacement = 'PhoenixBoxSpawner';
			if(e.Replacee is "SkullRodAmmo") 		e.Replacement = 'SkullStaffAmmoSpawner';
			if(e.Replacee is "SkullRodHefty") 		e.Replacement = 'SkullStaffAmmoBoxSpawner';
			if(e.Replacee is "MaceAmmo") 			e.Replacement = 'MaceStaffAmmoSpawner';
			if(e.Replacee is "MaceHefty") 			e.Replacement = 'MaceStaffAmmoBoxSpawner';
			
			//weapons
			if(e.Replacee is "Gauntlets") 			e.Replacement = 'GauntletSpawner';
			if(e.Replacee is "GoldWand") 			e.Replacement = 'GoldWandSpawner';
			if(e.Replacee is "Crossbow") 			e.Replacement = 'CrossbowSpawner';
			if(e.Replacee is "Blaster") 			e.Replacement = 'BlasterSpawner';
			if(e.Replacee is "PhoenixRod") 			e.Replacement = 'PhoenixSpawner';
			if(e.Replacee is "SkullRod") 			e.Replacement = 'SkullRodSpawner';
			if(e.Replacee is "Mace") 				e.Replacement = 'MaceRodSpawner';
			*/
			
			if(replace_items)
			{
				//items
				if(e.Replacee is "CrystalVial") 		e.Replacement = 'CrystalVialSpawner';
				if(e.Replacee is "ArtiHealth") 			e.Replacement = 'ArtiHealthSpawner';
				if(e.Replacee is "SilverShield") 		e.Replacement = 'SilverShieldSpawner';
				if(e.Replacee is "EnchantedShield") 	e.Replacement = 'EnchantedShieldSpawner';
				if(e.Replacee is "BagOfHolding") 		e.Replacement = 'HoldingBagSpawner';
				if(e.Replacee is "ArtiTomeOfPower") 	e.Replacement = 'PowerTomeSpawner';
			}
		}
	}

	private static bool CheckTitlemap()
	{
		bool isTitlemap = (level.mapname == "TITLEMAP");
		return isTitlemap;
	}
	
	private bool _isTitlemap;
	private bool _isInitialized;
	private bool replace_items;
	private int tic_count;
}